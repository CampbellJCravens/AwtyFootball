// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Player {
  id         String   @id @default(uuid())
  name       String
  pictureUrl String?
  team       String?  // "dark" or "white" or null
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
}

model Game {
  id        String   @id @default(uuid())
  gameNumber Int?     @unique // Persistent game number that doesn't change (nullable temporarily for migration)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  // Store game data as JSON
  // Team assignments: { playerId: "color" | "white" }
  teamAssignments String? // JSON string of Record<string, "color" | "white">
  
  // Goals: Array of { scorerId, assisterId?, timestamp, team }
  goals String? // JSON string of goal array
}

model AppSettings {
  id          String   @id @default("singleton")
  guestCount  Int      @default(0)
  updatedAt   DateTime @updatedAt
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  name      String?
  picture   String?
  role      String   @default("regular") // "admin" or "regular"
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model AllowedEmail {
  id        String   @id @default(uuid())
  email     String   @unique
  role      String   @default("regular") // "admin" or "regular"
  createdAt DateTime @default(now())
}

